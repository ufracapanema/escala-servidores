<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Lista de Férias</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">
    <div class="container">
        <div id="status" class="alert alert-info">Conectando à planilha...</div>
        <table class="table table-striped table-bordered bg-white shadow-sm" id="tabela" style="display:none;">
            <thead class="table-dark" id="cabecalho"></thead>
            <tbody id="corpo"></tbody>
        </table>
    </div>

    <script>
        // Use o link que baixa o arquivo "Página 1.csv"
        const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRKegsnxIiUPRWL3KMa9vgqmZJB3hCS9hSavAAYo3FYyOiegdGPoJJQOQ-vGbmumbEsNy2DUFxgDb2c/pub?output=csv';

        async function carregarDados() {
            try {
                const resposta = await fetch(url);
                if (!resposta.ok) throw new Error("Link inválido ou planilha não publicada.");
                
                const textoCsv = await resposta.text();
                
                // Divide as linhas e remove linhas vazias
                const linhas = textoCsv.split(/\r?\n/).filter(l => l.trim() !== "");
                
                // Processa cada linha removendo aspas extras
                const matriz = linhas.map(linha => 
                    linha.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/^"|"$/g, '').trim())
                );

                // Monta Cabeçalho
                const cabecalho = document.getElementById('cabecalho');
                let htmlHeader = "<tr>";
                matriz[0].forEach(col => htmlHeader += `<th>${col}</th>`);
                cabecalho.innerHTML = htmlHeader + "</tr>";

                // Monta Corpo
                const corpo = document.getElementById('corpo');
                let htmlCorpo = "";
                matriz.slice(1).forEach(linha => {
                    htmlCorpo += "<tr>";
                    linha.forEach(celula => htmlCorpo += `<td>${celula}</td>`);
                    htmlCorpo += "</tr>";
                });
                corpo.innerHTML = htmlCorpo;

                // Ajusta visibilidade
                document.getElementById('status').style.display = 'none';
                document.getElementById('tabela').style.display = 'table';

            } catch (erro) {
                document.getElementById('status').className = "alert alert-danger";
                document.getElementById('status').innerText = "Erro: " + erro.message;
            }
        }

        carregarDados();
    </script>
</body>
</html>
